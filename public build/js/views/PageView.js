define(["text!../../templates/page.html","views/GameView","lib/jquery.nivo.slider"],function(e,t,n){var r=Backbone.View.extend({tagName:"div",pageTemplate:_.template(e),initialize:function(e){this.pages=e.pages;var n=new t;n.render(),this.game=n.$el,this.views={}},events:{},initUnityPlayer:function(){console.log("init player");var e=this,t={width:800,height:450,params:{enableDebugging:"0"}};this.unityPlayer=new UnityObject2(t),jQuery(function(){var t=jQuery("#unityPlayer").find(".missing"),n=jQuery("#unityPlayer").find(".broken");t.hide(),n.hide(),console.log("after hide"),e.unityPlayer.observeProgress(function(r){switch(r.pluginStatus){case"broken":n.find("a").click(function(t){return t.stopPropagation(),t.preventDefault(),e.unityPlayer.installPlugin(),!1}),n.show();break;case"missing":t.find("a").click(function(t){return t.stopPropagation(),t.preventDefault(),e.unityPlayer.installPlugin(),!1}),t.show();break;case"installed":t.remove();break;case"first":}}),e.unityPlayer.initPlugin(jQuery("#unityPlayer")[0],"/web player.unity3d")})},renderPage:function(e){this.currentView&&(this.currentName=="shooter"?$("#unity-view").css({position:"absolute",left:-1e3,top:-1e3}):this.currentView.hide()),this.currentName=e,this.views[e]||(this.views[e]=$("<div></div>").html(this.pageTemplate(this.pages.get(e).toJSON())),console.log("new view "+e),this.$el.append(this.views[e]),e==="home"?this.$el.find("#game-div").html($('<div class="frame"></div>').html(this.game)):e==="bart-tracker"?this.$el.find("#slider").nivoSlider({pauseTime:1e6}):e==="siquoia"&&this.$el.find("#slider2").nivoSlider({pauseTime:1e6})),this.currentView=this.views[e],e=="shooter"&&(console.log(this.unityPlayer==undefined),this.unityPlayer||this.initUnityPlayer(),$("#unity-view").css({position:"fixed",left:100,top:100})),this.currentView.show()}});return r});